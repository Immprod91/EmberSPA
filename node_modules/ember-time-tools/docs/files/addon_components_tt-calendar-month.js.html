<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>addon/components/tt-calendar-month.js - ember-time-tools</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="ember-time-tools" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.3.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Calendar.CalendarMonthComponent.html">Calendar.CalendarMonthComponent</a></li>
                                <li><a href="../classes/Calendar.CalendarMonthEventComponent.html">Calendar.CalendarMonthEventComponent</a></li>
                                <li><a href="../classes/Calendar.CalendarWeekRowComponent.html">Calendar.CalendarWeekRowComponent</a></li>
                                <li><a href="../classes/Calendar.CalendarWeekrowDayComponent.html">Calendar.CalendarWeekrowDayComponent</a></li>
                                <li><a href="../classes/Calendar.EventContainerComponent.html">Calendar.EventContainerComponent</a></li>
                                <li><a href="../classes/Date.DateFieldComponent.html">Date.DateFieldComponent</a></li>
                                <li><a href="../classes/Date.DatePickerComponent.html">Date.DatePickerComponent</a></li>
                                <li><a href="../classes/Date.InputDateComponent.html">Date.InputDateComponent</a></li>
                                <li><a href="../classes/Date.PickerItemComponent.html">Date.PickerItemComponent</a></li>
                                <li><a href="../classes/Helpers.FormatDateHelper.html">Helpers.FormatDateHelper</a></li>
                                <li><a href="../classes/Time.InputTimeComponent.html">Time.InputTimeComponent</a></li>
                                <li><a href="../classes/Time.TimeFieldComponent.html">Time.TimeFieldComponent</a></li>
                                <li><a href="../classes/Time.TimePickerComponent.html">Time.TimePickerComponent</a></li>
                                <li><a href="../classes/Utils.DateObject.html">Utils.DateObject</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ember-time-tools.html">ember-time-tools</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: addon/components/tt-calendar-month.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
  @module ember-time-tools
*/
import Ember from &#x27;ember&#x27;;
import layout from &#x27;../templates/components/tt-calendar-month&#x27;;
import eventTemplate from &#x27;../templates/components/tt-calendar-month-event&#x27;;

const computed = Ember.computed;

var Day = Ember.Object.extend({
  date: null,
  month: null,
  year: null,
  inMonth: false
});

/**
  @class CalendarMonthComponent
  @namespace Calendar
*/
export default Ember.Component.extend({
  layout,

  /**
    This is the template to use for the events displayed in the calendar.

    @property eventTemplate
    @type {String}
  */
  eventTemplate: eventTemplate,

  /**
    @property classNames
    @type {Array}
    @default &#x60;[&#x27;tt-calendar-month&#x27;, &#x27;tt-calendar-container&#x27;]&#x60;
    @private
  */
  classNames: [&#x27;tt-calendar-month&#x27;, &#x27;tt-calendar-container&#x27;],

  /**
    These are the names for each day (column) displayed in the header.

    @property dayNames
    @type {Array}
    @default &#x60;[&#x27;Mon&#x27;, &#x27;Tue&#x27;, &#x27;Wed&#x27;, &#x27;Thu&#x27;, &#x27;Fri&#x27;, &#x27;Sat&#x27;, &#x27;Sun&#x27;]&#x60;
  */
  dayNames: [&#x27;Mon&#x27;, &#x27;Tue&#x27;, &#x27;Wed&#x27;, &#x27;Thu&#x27;, &#x27;Fri&#x27;, &#x27;Sat&#x27;, &#x27;Sun&#x27;],

  /**
    @property monthNames
    @type {Array}
    @default &#x60;[&#x27;January&#x27;, &#x27;February&#x27;, &#x27;March&#x27;, &#x27;April&#x27;, &#x27;May&#x27;, &#x27;June&#x27;, &#x27;July&#x27;, &#x27;August&#x27;, &#x27;September&#x27;, &#x27;October&#x27;, &#x27;November&#x27;, &#x27;December&#x27;]&#x60;
  */
  monthNames: [&#x27;January&#x27;, &#x27;February&#x27;, &#x27;March&#x27;, &#x27;April&#x27;, &#x27;May&#x27;, &#x27;June&#x27;, &#x27;July&#x27;, &#x27;August&#x27;, &#x27;September&#x27;, &#x27;October&#x27;, &#x27;November&#x27;, &#x27;December&#x27;],

  /**
    An array of event models.  Each event should have at least &#x60;start&#x60;, &#x60;end&#x60;
    and &#x60;description&#x60; properties.

      &#x60;&#x60;&#x60;
      var event = {
        description: &#x27;Event Title&#x27;
        start: timestamp,
        end: timestamp
      }
      &#x60;&#x60;&#x60;

    The timestamp can be an integer (milliseconds since 1/1/1970) or a Date object.

    @property events
    @type {Array}
  */
  events: null,

  /**
    @property sortProperties
    @type {Array}
    @default &#x60;[&#x27;start:asc&#x27;, &#x27;end:asc&#x27;]&#x60;
    @private
  */
  sortProperties: [&#x27;start:asc&#x27;, &#x27;end:asc&#x27;],

  /**
    Sorts the &#x60;events&#x60; array.

    @property sortedEvents
    @type {Array}
    @private
  */
  sortedEvents: computed.sort(&#x27;events&#x27;, &#x27;sortProperties&#x27;),

  /**
    The selected model/event.

    @property selected
    @type {Object}
  */
  selected: null,

  /**
    A &#x60;Date()&#x60; object representing the currently selected date.

    @property selectedDate
    @type {Object}
  */
  selectedDate: null,

  /**
    @method init
    @private
  */
  init: function () {
    this.setToday();
    return this._super();
  },

  /**
    The year of the &#x60;selectedDate&#x60;.

    @property year
    @type {Number}
    @private
  */
  year: computed( &#x27;selectedDate&#x27;, function() {
    var date = this.get(&#x27;selectedDate&#x27;) || new Date();
    return date.getFullYear();
  }),

  /**
    The month of the &#x60;selectedDate&#x60;.

    @property month
    @type {Number}
    @private
  */
  month: computed( &#x27;selectedDate&#x27;, function() {
    var date = this.get(&#x27;selectedDate&#x27;) || new Date();
    return date.getMonth();
  }),

  /**
    The month name string.. ie. &#x27;January&#x27;.

    @property monthName
    @type {String}
    @private
  */
  monthName: computed( &#x27;month&#x27;, &#x27;monthNames&#x27;, function () {
    var { month, monthNames } = this.getProperties([ &#x27;month&#x27;, &#x27;monthNames&#x27; ]);
    return monthNames[ month ];
  }),

  /**
    The number of the day ofthe week that the calendar will start on.
    Day numbers start at 0 = monday.

    @property startDay
    @type {Number}
    @private
  */
  startDay: computed( &#x27;year&#x27;, &#x27;month&#x27;, function () {
    var month = this.get(&#x27;month&#x27;),
      year = this.get(&#x27;year&#x27;),
      newCal = new Date(year, month, 1),
      startDay = newCal.getDay() - 1;

    if (startDay &lt; 0) {
      startDay = 6;
    }

    return startDay;
  }),

  /**
    @property weeks
    @type {Array}
    @private
  */
  weeks: computed( &#x27;month&#x27;, &#x27;year&#x27;, &#x27;startDay&#x27;, function () {

    const rows = 6;
    const days = 7;
    var out = Ember.A();
    var { month, year, startDay } = this.getProperties([ &#x27;month&#x27;, &#x27;year&#x27;, &#x27;startDay&#x27; ]);
    var lastMonth = this.getLastMonth( month );
    var daily = 0;
    var dailyNextMonth = 1;
    var daysInLastMonth = this.getDaysInMonth({ year:year, month: lastMonth });
    var daysInMonth = this.getDaysInMonth({ year:year, month:month });
    var outOfMonthDayObject = function (d) {
      var y = year;
      if ( 0 === daily ) {
        return {
          date: daysInLastMonth - (startDay - d)+1,
          month: (function (month) {
            var newMonth = month - 1;
            if (newMonth &lt; 0) {
              newMonth += 12;
              y--;
            }
            return newMonth;
          })(month),
          year: y
        };
      } else {
        return {
          date: dailyNextMonth++,
          month: (function (month) {
            var newMonth = month + 1;
            if (newMonth &gt; 11) {
              newMonth -= 12;
              y++;
            }
            return newMonth;
          })(month),
          year: y
        };
      }
    };

    for ( var w = 0; w &lt; rows; w++ ) {
      var daysArray = Ember.A();

      for (var d = 0; d &lt; days; d++) {
        // start the ball rolling when &#x60;d&#x60; is equal to &#x60;startDay&#x60;
        if ((d === startDay) &amp;&amp; (0 === daily)) {
          daily = 1;
        }

        if ((daily &gt; 0) &amp;&amp; daily &lt;= daysInMonth) {
          daysArray.pushObject(Day.create({
            date:daily++,
            month: month,
            year: year,
            inMonth: true
          }));
        } else {
          daysArray.pushObject( Day.create( outOfMonthDayObject( d ) ) );
        }
      }

      out.pushObject( daysArray );
    }
    return out;
  }),

  /**
    Pass in a month number and this function will return the previous month.

    @method getLastMonth
    @param {Integer} month starting at 0 = January
    @private
    @return {Integer}
  */
  getLastMonth(month) {
    var lastMonth = month - 1;
    if (lastMonth &lt; 0) {
      lastMonth += 12;
    }
    return lastMonth;
  },

  /**
    Get the number of days in the month.

    The &#x60;date&#x60; object passed in should be a POJO with &#x60;month&#x60; and &#x60;year&#x60; properties.

      &#x60;&#x60;&#x60;
      {
        year: 2015,
        month: 11 // starting from 0, 11 = December.
      }
      &#x60;&#x60;&#x60;


    @method getDaysInMonth
    @param {Object} date
    @private
    @return {Integer} The number of days in the month
  */
  getDaysInMonth(date) {
    const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
    var year = parseInt(date.year),
      month = parseInt(date.month);

    // test for leapyear when february is selected
    if (1 === month) {
      return ((0 === year % 4) &amp;&amp; (0 !== (year % 100))) || (0 === year % 400) ? 29 : 28;
    } else {
      return daysInMonth[month];
    }
  },

  /**
    Sets the &#x60;selected&#x60; property to &#x60;model&#x60;.

    This function is called when an event is clicked.

    @method select
    @param {Object} model
    @private
  */
  select( model ) {
    this.set( &#x27;selected&#x27;, model );
  },

  /**
    This is an empty method, it does nothing, just returns false.  It is meant
    only as a stub, to be extended, or passed in as a closure action via the
    template.

    The function will be called when an event is double-clicked.

    @method dblClick
    @private
    @return {Boolean} false
  */
  dblClick() {
    return false;
  },

  /**
    @method setToday
    @private
    @param {Object} date (optional) a &#x60;Date&#x60; object.
  */
  setToday: function (date) {
    if (!date) {
      date = new Date();
    }
    this.set(&#x27;selectedDate&#x27;, date);
  },

  /**
    @method _nextMonth
    @private
  */
  _nextMonth() {
    var date = this.get(&#x27;selectedDate&#x27;);
    if ( !date ) {
      date = new Date();
    }
    date.setDate(1);
    date.setMonth(date.getMonth() + 1);
    this.set(&#x27;selectedDate&#x27;, new Date(date));
  },

  /**
    @method _prevMonth
    @private
  */
  _prevMonth: function () {
    var date = this.get(&#x27;selectedDate&#x27;);
    if ( !date ) {
      date = new Date();
    }
    date.setDate(1);
    date.setMonth(date.getMonth() - 1);
    this.setToday(new Date(date));
  },

  actions: {
    /**
      ACTION

      @method nextMonth
    */
    nextMonth() {
      this._nextMonth();
    },

    /**
      ACTION

      @method prevMonth
    */
    prevMonth() {
      this._prevMonth();
    },

    /**
      ACTION

      @method today
    */
    today() {
      this.setToday();
    }
  }
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
