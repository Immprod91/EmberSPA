<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>addon/components/tt-date-picker.js - ember-time-tools</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="ember-time-tools" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.3.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Calendar.CalendarMonthComponent.html">Calendar.CalendarMonthComponent</a></li>
                                <li><a href="../classes/Calendar.CalendarMonthEventComponent.html">Calendar.CalendarMonthEventComponent</a></li>
                                <li><a href="../classes/Calendar.CalendarWeekRowComponent.html">Calendar.CalendarWeekRowComponent</a></li>
                                <li><a href="../classes/Calendar.CalendarWeekrowDayComponent.html">Calendar.CalendarWeekrowDayComponent</a></li>
                                <li><a href="../classes/Calendar.EventContainerComponent.html">Calendar.EventContainerComponent</a></li>
                                <li><a href="../classes/Date.DateFieldComponent.html">Date.DateFieldComponent</a></li>
                                <li><a href="../classes/Date.DatePickerComponent.html">Date.DatePickerComponent</a></li>
                                <li><a href="../classes/Date.InputDateComponent.html">Date.InputDateComponent</a></li>
                                <li><a href="../classes/Date.PickerItemComponent.html">Date.PickerItemComponent</a></li>
                                <li><a href="../classes/Helpers.FormatDateHelper.html">Helpers.FormatDateHelper</a></li>
                                <li><a href="../classes/Time.InputTimeComponent.html">Time.InputTimeComponent</a></li>
                                <li><a href="../classes/Time.TimeFieldComponent.html">Time.TimeFieldComponent</a></li>
                                <li><a href="../classes/Time.TimePickerComponent.html">Time.TimePickerComponent</a></li>
                                <li><a href="../classes/Utils.DateObject.html">Utils.DateObject</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ember-time-tools.html">ember-time-tools</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: addon/components/tt-date-picker.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
  @module ember-time-tools
*/
import Ember from &#x27;ember&#x27;;
import layout from &#x27;../templates/components/tt-date-picker&#x27;;
import DateObject from &#x27;ember-time-tools/utils/date&#x27;;
import ClickOutsideMixin from &#x27;ember-ui-components/mixins/click-outside&#x27;;

const { computed } = Ember;
const { readOnly } = computed;

/*
  @param daysInMonth
    The number of days in each month.
*/
const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

/*
  @method getDays
    gets the number of days in the month (tests for leap years)

  @param (Integer) month

  @param (Integer) year

  @return (Integer)
    The number of days in the month.
*/
function getDays(date) {
  let year = parseInt(date.year),
    month = parseInt(date.month);

  // Test for leap year when February is selected.
  if (1 === month) {
    return ((0 === year % 4) &amp;&amp; (0 !== (year % 100))) || (0 === year % 400) ? 29 : 28;
  } else {
    return daysInMonth[month];
  }
}

/**
  @class DatePickerComponent
  @namespace Date
*/
export default Ember.Component.extend(ClickOutsideMixin, {

  layout,

  /**
    @property classNames
    @type {Array}
    @private
    @default &#x60;[&#x27;tt-date-picker&#x27;, &#x27;container&#x27;]&#x60;
  */
  classNames: [&#x27;tt-date-picker&#x27;, &#x27;container&#x27;],

  /**
    An array of month names.
    @property months
    @type {Array}
    @private
  */
  months: [&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;],

  /**
    0 = Sunday, 1 = Monday

    @property weekStart
    @type {Integer}
    @private
    @default &#x60;1&#x60;
  */
  weekStart: 1,

  /**
    The number of week rows to display in the calendar.

    @property numberOfWeeks
    @type {Integer}
    @private
    @default 6
  */
  numberOfWeeks: 6,

   /**
    ### Output

    Options:

    * date - javascript &#x60;Date&#x60; object.
    * timestamp - number of seconds.
    * object - &#x60;Ember.Object&#x60; with &#x60;year&#x60;, &#x60;month&#x60; and &#x60;date&#x60; properties.

    @property output
    @type {String}
    @default &#x27;date&#x27;
  */
  output: &#x27;date&#x27;,

  /**
    @property selectedDate
    @type {Number}
  */
  selectedDate: null,

  /**
    @property viewDate
    @type {Object}
    @private
  */
  viewDate: null,

  /**
    @property year
    @type {Number}
    @readonly
    @private
  */
  year: readOnly(&#x27;viewDate.year&#x27;),

  /**
    @property month
    @type {Number}
    @readonly
    @private
  */
  month: readOnly(&#x27;viewDate.month&#x27;),

  /**
    An Ember.Array containing an object for each day of the week.  Each object
    has a &#x60;name&#x60; property that is used for the day title.

    @property daysOfWeek
    @type {Array}
    @private
  */
  daysOfWeek: computed(&#x27;weekStart&#x27;, function() {
    let array = Ember.A(),
      weekStart = this.get(&#x27;weekStart&#x27;),
      daysArray = [&quot;S&quot;, &quot;M&quot;, &quot;T&quot;, &quot;W&quot;, &quot;T&quot;, &quot;F&quot;, &quot;S&quot;];

    if (weekStart === 1) {
      daysArray.push(daysArray.shift());
    }

    for (let i = 0, d = daysArray.length; i &lt; d; i++) {
      array.pushObject({name:daysArray[i]});
    }
    return array;
  }),

  /**
    The name of the month specified by &#x60;month&#x60;.

    @property monthName
    @type {String}
    @private
  */
  monthName: computed(&#x27;month&#x27;, &#x27;months&#x27;, function () {
    return this.get(&#x27;months&#x27;)[this.get(&#x27;month&#x27;)];
  }),

  /**
    @property weeks
    @type {Array}
    @private
  */
  weeks: computed(&#x27;daysOfWeek.[]&#x27;, &#x27;month&#x27;, &#x27;year&#x27;, &#x27;numberOfWeeks&#x27;, &#x27;startDay&#x27;, function() {
    let dayObj, date, intWeek, intDay, week,
      daily = 0,
      dailyNextMonth = 1,
      weeksArray = Ember.A(),
      daysOfWeek = this.get(&#x27;daysOfWeek.length&#x27;),
      { month, year, numberOfWeeks, startDay } = this.getProperties(&#x27;month&#x27;, &#x27;year&#x27;, &#x27;numberOfWeeks&#x27;, &#x27;startDay&#x27;),
      daysInMonth = getDays({ year, month });

    for (intWeek = 0; intWeek &lt; numberOfWeeks;  intWeek++) {
      week = Ember.A();

      for (intDay = 0;intDay &lt; daysOfWeek; intDay++) {
        // start the ball rolling when intDay is equal to startDay
        if ((intDay === startDay) &amp;&amp; (0 === daily)) {
          daily = 1;
        }
        if ((daily &gt; 0) &amp;&amp; (daily &lt;= daysInMonth)) {
          dayObj = {
            date: daily++,
            month: month,
            year: year,
            inRange: true
          };
        } else {
          if (0 === daily) {
            date = new Date(year, month, 1);
            date.setDate(date.getDate() - (startDay - intDay));
          } else {
            date = new Date(year, month + 1, 0);
            date.setDate(date.getDate() + dailyNextMonth++);
          }

          dayObj = {
            date: date.getDate(),
            month: date.getMonth(),
            year: date.getFullYear(),
            inRange: false
          };
        }
        week.pushObject(Ember.Object.create(dayObj));
      }
      weeksArray.pushObject(week);
    }
    return weeksArray;
  }),

   /**
    @property startDay
    @type {Integer}
    @private
  */
  startDay: computed( &#x27;year&#x27;, &#x27;month&#x27;, &#x27;weekStart&#x27;, function () {
    let { month, year } = this.getProperties(&#x27;month&#x27;, &#x27;year&#x27;),
      newCal = new Date(year, month, 1),
      startDay = newCal.getDay() - this.get(&#x27;weekStart&#x27;);

    if (startDay &lt; 0) {
      startDay = 6;
    }

    return startDay;
  }),

  /**
    @method init
    @private
  */
  init() {
    this._super(...arguments);
    let selectedDate = this.get(&#x27;selectedDate&#x27;);
    this.set(&#x27;viewDate&#x27;, DateObject.create());
    if (selectedDate) {
      this.setViewDate(selectedDate);
    }
  },

  /**
    @method handleClickOutside
    @private
  */
  handleClickOutside() {
    if (this.get(&#x27;isDestroyed&#x27;) || this.get(&#x27;isDestroying&#x27;)) { return; }
    this.sendAction(&#x27;close&#x27;);
  },

  /**
    Set &#x60;viewDate&#x60; to today.

    @method setToday
    @private
  */
  setToday() {
    this.setViewDate(new Date());
  },

  /**
    @method setViewDate
    @param {Object} date A javascript &#x60;Date&#x60; object
    @private
  */
  setViewDate(date) {
    this.set(&#x27;viewDate.date&#x27;, date);
  },

  /**
    &#x60;day&#x60; is an object with &#x60;date&#x60;, &#x60;month&#x60; and &#x60;year&#x60; properties.

    @method _selectDate
    @param {Object} day
    @private
  */
  _selectDate(day) {
    let output = this.get(&#x27;output&#x27;);
    let date = new Date(day.year, day.month, day.date);

    if (output) {
      switch(output) {
        case &#x27;date&#x27;:
          day = date;
          break;
        case &#x27;timestamp&#x27;:
          day = date.getTime();
          break;
        case &#x27;object&#x27;:
          day = Ember.Object.create({
            year: day.year,
            month: day.month,
            date: day.date,
            _date: date,
            timestamp: date.getTime()
          });
          break;
        default:
          day = Ember.Object.create({
            year: day.year,
            month: day.month,
            date: day.date,
            _date: date,
            timestamp: date.getTime()
          });
          break;
      }
    }

    if (this.get(&#x27;select&#x27;)) {
      this.sendAction(&#x27;select&#x27;, day);
    } else {
      this.set(&#x27;selectedDate&#x27;, day);
    }

  },

  /**
    @method _prevMonth
    @private
  */
  _prevMonth() {
    this.get(&#x27;viewDate&#x27;).decrementMonth();
  },

  /**
    @method _nextMonth
    @private
  */
  _nextMonth() {
    this.get(&#x27;viewDate&#x27;).incrementMonth();
  },

  actions: {

    /**
      ACTION - Send action &#x27;select&#x27;

      @method selectDay
      @param {Object} day
    */
    selectDay(day) {
      this._selectDate(day);
    },

    /**
      ACTION - change the &#x60;viewDate&#x60; to the previous month.

      @method prevMonth
    */
    prevMonth() {
      this._prevMonth();
    },

    /**
      ACTION - change the &#x60;viewDate&#x60; to the next month.

      @method nextMonth
    */
    nextMonth() {
      this._nextMonth();
    },

    /**
      ACTION - Calls &#x60;this.setToday()&#x60;.

      @method today
    */
    today() {
      this.setToday();
    },

    /**
      ACTION - Send action &#x27;close&#x27;.
      @method close
    */
    close() {
      this.sendAction(&#x27;close&#x27;);
    }
  }
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
